from dataclasses import dataclass
from goat.classes.plugin_base import PluginBase
from .service import MarketAnalysisService
from .parameters import AnalyzeMarketDataParameters


@dataclass
class MarketAnalysisPluginOptions:
    """Options for the MarketAnalysisPlugin."""
    openrouter_key: str  # OpenRouter API key for DeepSeek-R1 integration


class MarketAnalysisPlugin(PluginBase):
    def __init__(self, options: MarketAnalysisPluginOptions):
        super().__init__("market_analysis", [MarketAnalysisService(options.openrouter_key)])

    def supports_chain(self, chain) -> bool:
        return True


def market_analysis(options: MarketAnalysisPluginOptions) -> MarketAnalysisPlugin:
    return MarketAnalysisPlugin(options)


__all__ = ["MarketAnalysisPlugin", "MarketAnalysisPluginOptions", "AnalyzeMarketDataParameters", "market_analysis"]
